var JSON;JSON||(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,s,o,a,l=gap,r=e[t];switch(r&&"object"==typeof r&&"function"==typeof r.toJSON&&(r=r.toJSON(t)),"function"==typeof rep&&(r=rep.call(e,t,r)),typeof r){case"string":return quote(r);case"number":return isFinite(r)?r+"":"null";case"boolean":case"null":return r+"";case"object":if(!r)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(r)){for(o=r.length,i=0;o>i;i+=1)a[i]=str(i,r)||"null";return s=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+l+"]":"["+a.join(",")+"]",gap=l,s}if(rep&&"object"==typeof rep)for(o=rep.length,i=0;o>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],s=str(n,r),s&&a.push(quote(n)+(gap?": ":":")+s));else for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s=str(n,r),s&&a.push(quote(n)+(gap?": ":":")+s));return s=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+l+"}":"{"+a.join(",")+"}",gap=l,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var i,n,s=t[e];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n=walk(s,i),void 0!==n?s[i]=n:delete s[i]);return reviver.call(t,e,s)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){function t(e,i,n){if(e===i)return 0!==e||1/e==1/i;if(null==e||null==i)return e===i;if(e._chain&&(e=e._wrapped),i._chain&&(i=i._wrapped),e.isEqual&&w.isFunction(e.isEqual))return e.isEqual(i);if(i.isEqual&&w.isFunction(i.isEqual))return i.isEqual(e);var s=r.call(e);if(s!=r.call(i))return!1;switch(s){case"[object String]":return e==""+i;case"[object Number]":return e!=+e?i!=+i:0==e?1/e==1/i:e==+i;case"[object Date]":case"[object Boolean]":return+e==+i;case"[object RegExp]":return e.source==i.source&&e.global==i.global&&e.multiline==i.multiline&&e.ignoreCase==i.ignoreCase}if("object"!=typeof e||"object"!=typeof i)return!1;for(var o=n.length;o--;)if(n[o]==e)return!0;n.push(e);var o=0,a=!0;if("[object Array]"==s){if(o=e.length,a=o==i.length)for(;o--&&(a=o in e==o in i&&t(e[o],i[o],n)););}else{if("constructor"in e!="constructor"in i||e.constructor!=i.constructor)return!1;for(var l in e)if(w.has(e,l)&&(o++,!(a=w.has(i,l)&&t(e[l],i[l],n))))break;if(a){for(l in i)if(w.has(i,l)&&!o--)break;a=!o}}return n.pop(),a}var e=this,i=e._,n={},s=Array.prototype,o=Object.prototype,a=s.slice,l=s.unshift,r=o.toString,h=o.hasOwnProperty,d=s.forEach,c=s.map,u=s.reduce,p=s.reduceRight,m=s.filter,g=s.every,f=s.some,v=s.indexOf,y=s.lastIndexOf,o=Array.isArray,b=Object.keys,x=Function.prototype.bind,w=function(t){return new F(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):e._=w,w.VERSION="1.3.3";var $=w.each=w.forEach=function(t,e,i){if(null!=t)if(d&&t.forEach===d)t.forEach(e,i);else if(t.length===+t.length)for(var s=0,o=t.length;o>s&&!(s in t&&e.call(i,t[s],s,t)===n);s++);else for(s in t)if(w.has(t,s)&&e.call(i,t[s],s,t)===n)break};w.map=w.collect=function(t,e,i){var n=[];return null==t?n:c&&t.map===c?t.map(e,i):($(t,function(t,s,o){n[n.length]=e.call(i,t,s,o)}),t.length===+t.length&&(n.length=t.length),n)},w.reduce=w.foldl=w.inject=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),u&&t.reduce===u)return n&&(e=w.bind(e,n)),s?t.reduce(e,i):t.reduce(e);if($(t,function(t,o,a){s?i=e.call(n,i,t,o,a):(i=t,s=!0)}),!s)throw new TypeError("Reduce of empty array with no initial value");return i},w.reduceRight=w.foldr=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return n&&(e=w.bind(e,n)),s?t.reduceRight(e,i):t.reduceRight(e);var o=w.toArray(t).reverse();return n&&!s&&(e=w.bind(e,n)),s?w.reduce(o,e,i,n):w.reduce(o,e)},w.find=w.detect=function(t,e,i){var n;return C(t,function(t,s,o){return e.call(i,t,s,o)?(n=t,!0):void 0}),n},w.filter=w.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):($(t,function(t,s,o){e.call(i,t,s,o)&&(n[n.length]=t)}),n)},w.reject=function(t,e,i){var n=[];return null==t?n:($(t,function(t,s,o){e.call(i,t,s,o)||(n[n.length]=t)}),n)},w.every=w.all=function(t,e,i){var s=!0;return null==t?s:g&&t.every===g?t.every(e,i):($(t,function(t,o,a){return(s=s&&e.call(i,t,o,a))?void 0:n}),!!s)};var C=w.some=w.any=function(t,e,i){e||(e=w.identity);var s=!1;return null==t?s:f&&t.some===f?t.some(e,i):($(t,function(t,o,a){return s||(s=e.call(i,t,o,a))?n:void 0}),!!s)};w.include=w.contains=function(t,e){var i=!1;return null==t?i:v&&t.indexOf===v?-1!=t.indexOf(e):i=C(t,function(t){return t===e})},w.invoke=function(t,e){var i=a.call(arguments,2);return w.map(t,function(t){return(w.isFunction(e)?e||t:t[e]).apply(t,i)})},w.pluck=function(t,e){return w.map(t,function(t){return t[e]})},w.max=function(t,e,i){if(!e&&w.isArray(t)&&t[0]===+t[0])return Math.max.apply(Math,t);if(!e&&w.isEmpty(t))return-1/0;var n={computed:-1/0};return $(t,function(t,s,o){s=e?e.call(i,t,s,o):t,s>=n.computed&&(n={value:t,computed:s})}),n.value},w.min=function(t,e,i){if(!e&&w.isArray(t)&&t[0]===+t[0])return Math.min.apply(Math,t);if(!e&&w.isEmpty(t))return 1/0;var n={computed:1/0};return $(t,function(t,s,o){s=e?e.call(i,t,s,o):t,n.computed>s&&(n={value:t,computed:s})}),n.value},w.shuffle=function(t){var e,i=[];return $(t,function(t,n){e=Math.floor(Math.random()*(n+1)),i[n]=i[e],i[e]=t}),i},w.sortBy=function(t,e,i){var n=w.isFunction(e)?e:function(t){return t[e]};return w.pluck(w.map(t,function(t,e,s){return{value:t,criteria:n.call(i,t,e,s)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;return void 0===i?1:void 0===n?-1:n>i?-1:i>n?1:0}),"value")},w.groupBy=function(t,e){var i={},n=w.isFunction(e)?e:function(t){return t[e]};return $(t,function(t,e){var s=n(t,e);(i[s]||(i[s]=[])).push(t)}),i},w.sortedIndex=function(t,e,i){i||(i=w.identity);for(var n=0,s=t.length;s>n;){var o=n+s>>1;i(t[o])<i(e)?n=o+1:s=o}return n},w.toArray=function(t){return t?w.isArray(t)||w.isArguments(t)?a.call(t):t.toArray&&w.isFunction(t.toArray)?t.toArray():w.values(t):[]},w.size=function(t){return w.isArray(t)?t.length:w.keys(t).length},w.first=w.head=w.take=function(t,e,i){return null==e||i?t[0]:a.call(t,0,e)},w.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},w.last=function(t,e,i){return null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},w.rest=w.tail=function(t,e,i){return a.call(t,null==e||i?1:e)},w.compact=function(t){return w.filter(t,function(t){return!!t})},w.flatten=function(t,e){return w.reduce(t,function(t,i){return w.isArray(i)?t.concat(e?i:w.flatten(i)):(t[t.length]=i,t)},[])},w.without=function(t){return w.difference(t,a.call(arguments,1))},w.uniq=w.unique=function(t,e,i){var i=i?w.map(t,i):t,n=[];return 3>t.length&&(e=!0),w.reduce(i,function(i,s,o){return(e?w.last(i)===s&&i.length:w.include(i,s))||(i.push(s),n.push(t[o])),i},[]),n},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(t){var e=a.call(arguments,1);return w.filter(w.uniq(t),function(t){return w.every(e,function(e){return w.indexOf(e,t)>=0})})},w.difference=function(t){var e=w.flatten(a.call(arguments,1),!0);return w.filter(t,function(t){return!w.include(e,t)})},w.zip=function(){for(var t=a.call(arguments),e=w.max(w.pluck(t,"length")),i=Array(e),n=0;e>n;n++)i[n]=w.pluck(t,""+n);return i},w.indexOf=function(t,e,i){if(null==t)return-1;var n;if(i)return i=w.sortedIndex(t,e),t[i]===e?i:-1;if(v&&t.indexOf===v)return t.indexOf(e);for(i=0,n=t.length;n>i;i++)if(i in t&&t[i]===e)return i;return-1},w.lastIndexOf=function(t,e){if(null==t)return-1;if(y&&t.lastIndexOf===y)return t.lastIndexOf(e);for(var i=t.length;i--;)if(i in t&&t[i]===e)return i;return-1},w.range=function(t,e,i){1>=arguments.length&&(e=t||0,t=0);for(var i=arguments[2]||1,n=Math.max(Math.ceil((e-t)/i),0),s=0,o=Array(n);n>s;)o[s++]=t,t+=i;return o};var E=function(){};w.bind=function(t,e){var i,n;if(t.bind===x&&x)return x.apply(t,a.call(arguments,1));if(!w.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));E.prototype=t.prototype;var s=new E,o=t.apply(s,n.concat(a.call(arguments)));return Object(o)===o?o:s}},w.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=w.functions(t)),$(e,function(e){t[e]=w.bind(t[e],t)}),t},w.memoize=function(t,e){var i={};return e||(e=w.identity),function(){var n=e.apply(this,arguments);return w.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},w.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},w.defer=function(t){return w.delay.apply(w,[t,1].concat(a.call(arguments,1)))},w.throttle=function(t,e){var i,n,s,o,a,l,r=w.debounce(function(){a=o=!1},e);return function(){return i=this,n=arguments,s||(s=setTimeout(function(){s=null,a&&t.apply(i,n),r()},e)),o?a=!0:l=t.apply(i,n),r(),o=!0,l}},w.debounce=function(t,e,i){var n;return function(){var s=this,o=arguments;i&&!n&&t.apply(s,o),clearTimeout(n),n=setTimeout(function(){n=null,i||t.apply(s,o)},e)}},w.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments))}},w.wrap=function(t,e){return function(){var i=[t].concat(a.call(arguments,0));return e.apply(this,i)}},w.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},w.after=function(t,e){return 0>=t?e():function(){return 1>--t?e.apply(this,arguments):void 0}},w.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e,i=[];for(e in t)w.has(t,e)&&(i[i.length]=e);return i},w.values=function(t){return w.map(t,w.identity)},w.functions=w.methods=function(t){var e,i=[];for(e in t)w.isFunction(t[e])&&i.push(e);return i.sort()},w.extend=function(t){return $(a.call(arguments,1),function(e){for(var i in e)t[i]=e[i]}),t},w.pick=function(t){var e={};return $(w.flatten(a.call(arguments,1)),function(i){i in t&&(e[i]=t[i])}),e},w.defaults=function(t){return $(a.call(arguments,1),function(e){for(var i in e)null==t[i]&&(t[i]=e[i])}),t},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isEqual=function(e,i){return t(e,i,[])},w.isEmpty=function(t){if(null==t)return!0;if(w.isArray(t)||w.isString(t))return 0===t.length;for(var e in t)if(w.has(t,e))return!1;return!0},w.isElement=function(t){return!(!t||1!=t.nodeType)},w.isArray=o||function(t){return"[object Array]"==r.call(t)},w.isObject=function(t){return t===Object(t)},w.isArguments=function(t){return"[object Arguments]"==r.call(t)},w.isArguments(arguments)||(w.isArguments=function(t){return!(!t||!w.has(t,"callee"))}),w.isFunction=function(t){return"[object Function]"==r.call(t)},w.isString=function(t){return"[object String]"==r.call(t)},w.isNumber=function(t){return"[object Number]"==r.call(t)},w.isFinite=function(t){return w.isNumber(t)&&isFinite(t)},w.isNaN=function(t){return t!==t},w.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==r.call(t)},w.isDate=function(t){return"[object Date]"==r.call(t)},w.isRegExp=function(t){return"[object RegExp]"==r.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return h.call(t,e)},w.noConflict=function(){return e._=i,this},w.identity=function(t){return t},w.times=function(t,e,i){for(var n=0;t>n;n++)e.call(i,n)},w.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.result=function(t,e){if(null==t)return null;var i=t[e];return w.isFunction(i)?i.call(t):i},w.mixin=function(t){$(w.functions(t),function(e){D(e,w[e]=t[e])})};var T=0;w.uniqueId=function(t){var e=T++;return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var k,A=/.^/,V={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(k in V)V[V[k]]=k;var S=/\\|'|\r|\n|\t|\u2028|\u2029/g,O=/\\(\\|'|r|n|t|u2028|u2029)/g,N=function(t){return t.replace(O,function(t,e){return V[e]})};w.template=function(t,e,i){i=w.defaults(i||{},w.templateSettings),t="__p+='"+t.replace(S,function(t){return"\\"+V[t]}).replace(i.escape||A,function(t,e){return"'+\n_.escape("+N(e)+")+\n'"}).replace(i.interpolate||A,function(t,e){return"'+\n("+N(e)+")+\n'"}).replace(i.evaluate||A,function(t,e){return"';\n"+N(e)+"\n;__p+='"})+"';\n",i.variable||(t="with(obj||{}){\n"+t+"}\n");var t="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+t+"return __p;\n",n=Function(i.variable||"obj","_",t);return e?n(e,w):(e=function(t){return n.call(this,t,w)},e.source="function("+(i.variable||"obj")+"){\n"+t+"}",e)},w.chain=function(t){return w(t).chain()};var F=function(t){this._wrapped=t};w.prototype=F.prototype;var P=function(t,e){return e?w(t).chain():t},D=function(t,e){F.prototype[t]=function(){var t=a.call(arguments);return l.call(t,this._wrapped),P(e.apply(w,t),this._chain)}};w.mixin(w),$("pop,push,reverse,shift,sort,splice,unshift".split(","),function(t){var e=s[t];F.prototype[t]=function(){var i=this._wrapped;e.apply(i,arguments);var n=i.length;return("shift"==t||"splice"==t)&&0===n&&delete i[0],P(i,this._chain)}}),$(["concat","join","slice"],function(t){var e=s[t];F.prototype[t]=function(){return P(e.apply(this._wrapped,arguments),this._chain)}}),F.prototype.chain=function(){return this._chain=!0,this},F.prototype.value=function(){return this._wrapped}}.call(this),function(){var t,e=this,i=e.Backbone,n=Array.prototype.slice,s=Array.prototype.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="0.9.2";var o=e._;!o&&"undefined"!=typeof require&&(o=require("underscore"));var a=e.jQuery||e.Zepto||e.ender;t.setDomLibrary=function(t){a=t},t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=/\s+/,r=t.Events={on:function(t,e,i){var n,s,o,a,r;if(!e)return this;for(t=t.split(l),n=this._callbacks||(this._callbacks={});s=t.shift();)o=(r=n[s])?r.tail:{},o.next=a={},o.context=i,o.callback=e,n[s]={tail:a,next:r?r.next:o};return this},off:function(t,e,i){var n,s,a,r,h,d;if(s=this._callbacks){if(!t&&!e&&!i)return delete this._callbacks,this;for(t=t?t.split(l):o.keys(s);n=t.shift();)if(a=s[n],delete s[n],a&&(e||i))for(r=a.tail;(a=a.next)!==r;)h=a.callback,d=a.context,(e&&h!==e||i&&d!==i)&&this.on(n,h,d);return this}},trigger:function(t){var e,i,s,o,a,r;if(!(s=this._callbacks))return this;for(a=s.all,t=t.split(l),r=n.call(arguments,1);e=t.shift();){if(i=s[e])for(o=i.tail;(i=i.next)!==o;)i.callback.apply(i.context||this,r);if(i=a)for(o=i.tail,e=[e].concat(r);(i=i.next)!==o;)i.callback.apply(i.context||this,e)}return this}};r.bind=r.on,r.unbind=r.off;var h=t.Model=function(t,e){var i;t||(t={}),e&&e.parse&&(t=this.parse(t)),(i=E(this,"defaults"))&&(t=o.extend({},i,t)),e&&e.collection&&(this.collection=e.collection),this.attributes={},this._escapedAttributes={},this.cid=o.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(t,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=o.clone(this.attributes),this.initialize.apply(this,arguments)};o.extend(h.prototype,r,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return o.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){var e;return(e=this._escapedAttributes[t])?e:(e=this.get(t),this._escapedAttributes[t]=o.escape(null==e?"":""+e))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,s;if(o.isObject(t)||null==t?(n=t,i=e):(n={},n[t]=e),i||(i={}),!n)return this;if(n instanceof h&&(n=n.attributes),i.unset)for(s in n)n[s]=void 0;if(!this._validate(n,i))return!1;this.idAttribute in n&&(this.id=n[this.idAttribute]);var e=i.changes={},a=this.attributes,l=this._escapedAttributes,r=this._previousAttributes||{};for(s in n)t=n[s],(!o.isEqual(a[s],t)||i.unset&&o.has(a,s))&&(delete l[s],(i.silent?this._silent:e)[s]=!0),i.unset?delete a[s]:a[s]=t,o.isEqual(r[s],t)&&o.has(a,s)==o.has(r,s)?(delete this.changed[s],delete this._pending[s]):(this.changed[s]=t,i.silent||(this._pending[s]=!0));return i.silent||this.change(i),this},unset:function(t,e){return(e||(e={})).unset=!0,this.set(t,null,e)},clear:function(t){return(t||(t={})).unset=!0,this.set(o.clone(this.attributes),t)},fetch:function(e){var e=e?o.clone(e):{},i=this,n=e.success;return e.success=function(t,s,o){return i.set(i.parse(t,o),e)?(n&&n(i,t),void 0):!1},e.error=t.wrapError(e.error,i,e),(this.sync||t.sync).call(this,"read",this,e)},save:function(e,i,n){var s,a;if(o.isObject(e)||null==e?(s=e,n=i):(s={},s[e]=i),n=n?o.clone(n):{},n.wait){if(!this._validate(s,n))return!1;a=o.clone(this.attributes)}if(e=o.extend({},n,{silent:!0}),s&&!this.set(s,n.wait?e:n))return!1;var l=this,r=n.success;return n.success=function(t,e,i){return e=l.parse(t,i),n.wait&&(delete n.wait,e=o.extend(s||{},e)),l.set(e,n)?(r?r(l,t):l.trigger("sync",l,t,n),void 0):!1},n.error=t.wrapError(n.error,l,n),i=this.isNew()?"create":"update",i=(this.sync||t.sync).call(this,i,this,n),n.wait&&this.set(a,e),i},destroy:function(e){var e=e?o.clone(e):{},i=this,n=e.success,s=function(){i.trigger("destroy",i,i.collection,e)};if(this.isNew())return s(),!1;e.success=function(t){e.wait&&s(),n?n(i,t):i.trigger("sync",i,t,e)},e.error=t.wrapError(e.error,i,e);var a=(this.sync||t.sync).call(this,"delete",this,e);return e.wait||s(),a},url:function(){var t=E(this,"urlRoot")||E(this.collection,"url")||T();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var e=this._changing;this._changing=!0;for(var i in this._silent)this._pending[i]=!0;var n=o.extend({},t.changes,this._silent);this._silent={};for(i in n)this.trigger("change:"+i,this,this.get(i),t);if(e)return this;for(;!o.isEmpty(this._pending);){this._pending={},this.trigger("change",this,t);for(i in this.changed)!this._pending[i]&&!this._silent[i]&&delete this.changed[i];this._previousAttributes=o.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(t){return arguments.length?o.has(this.changed,t):!o.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1;var e,i,n=!1,s=this._previousAttributes;for(i in t)o.isEqual(s[i],e=t[i])||((n||(n={}))[i]=e);return n},previous:function(t){return arguments.length&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,e){if(e.silent||!this.validate)return!0;var t=o.extend({},this.attributes,t),i=this.validate(t,e);return i?(e&&e.error?e.error(this,i,e):this.trigger("error",this,i,e),!1):!0}});var d=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0,parse:e.parse})};o.extend(d.prototype,r,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){var i,n,a,l,r,h={},d={},c=[];for(e||(e={}),t=o.isArray(t)?t.slice():[t],i=0,n=t.length;n>i;i++){if(!(a=t[i]=this._prepareModel(t[i],e)))throw Error("Can't add an invalid model to a collection");l=a.cid,r=a.id,h[l]||this._byCid[l]||null!=r&&(d[r]||this._byId[r])?c.push(i):h[l]=d[r]=a}for(i=c.length;i--;)t.splice(c[i],1);for(i=0,n=t.length;n>i;i++)(a=t[i]).on("all",this._onModelEvent,this),this._byCid[a.cid]=a,null!=a.id&&(this._byId[a.id]=a);if(this.length+=n,s.apply(this.models,[null!=e.at?e.at:this.models.length,0].concat(t)),this.comparator&&this.sort({silent:!0}),e.silent)return this;for(i=0,n=this.models.length;n>i;i++)h[(a=this.models[i]).cid]&&(e.index=i,a.trigger("add",a,this,e));return this},remove:function(t,e){var i,n,s,a;for(e||(e={}),t=o.isArray(t)?t.slice():[t],i=0,n=t.length;n>i;i++)(a=this.getByCid(t[i])||this.get(t[i]))&&(delete this._byId[a.id],delete this._byCid[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,e.silent||(e.index=s,a.trigger("remove",a,this,e)),this._removeReference(a));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,e),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return o.isEmpty(t)?[]:this.filter(function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},sort:function(t){if(t||(t={}),!this.comparator)throw Error("Cannot sort a set without a comparator");var e=o.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return o.map(this.models,function(e){return e.get(t)})},reset:function(t,e){t||(t=[]),e||(e={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return this._reset(),this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(e){e=e?o.clone(e):{},void 0===e.parse&&(e.parse=!0);var i=this,n=e.success;return e.success=function(t,s,o){i[e.add?"add":"reset"](i.parse(t,o),e),n&&n(i,t)},e.error=t.wrapError(e.error,i,e),(this.sync||t.sync).call(this,"read",this,e)},create:function(t,e){var i=this,e=e?o.clone(e):{},t=this._prepareModel(t,e);if(!t)return!1;e.wait||i.add(t,e);var n=e.success;return e.success=function(s,o){e.wait&&i.add(s,e),n?n(s,o):s.trigger("sync",t,o,e)},t.save(null,e),t},parse:function(t){return t},chain:function(){return o(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,e){return e||(e={}),t instanceof h?t.collection||(t.collection=this):(e.collection=this,t=new this.model(t,e),t._validate(t.attributes,e)||(t=!1)),t},_removeReference:function(t){this==t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"==t||"remove"==t)&&i!=this||("destroy"==t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}}),o.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(t){d.prototype[t]=function(){return o[t].apply(o,[this.models].concat(o.toArray(arguments)))}});var c=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},u=/:\w+/g,p=/\*\w+/g,m=/[-[\]{}()+?.,\\^$|#\s]/g;o.extend(c.prototype,r,{initialize:function(){},route:function(e,i,n){return t.history||(t.history=new g),o.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[i]),t.history.route(e,o.bind(function(s){s=this._extractParameters(e,s),n&&n.apply(this,s),this.trigger.apply(this,["route:"+i].concat(s)),t.history.trigger("route",this,i,s)},this)),this},navigate:function(e,i){t.history.navigate(e,i)},_bindRoutes:function(){if(this.routes){var t,e=[];for(t in this.routes)e.unshift([t,this.routes[t]]);t=0;for(var i=e.length;i>t;t++)this.route(e[t][0],e[t][1],this[e[t][1]])}},_routeToRegExp:function(t){return t=t.replace(m,"\\$&").replace(u,"([^/]+)").replace(p,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var g=t.History=function(){this.handlers=[],o.bindAll(this,"checkUrl")},f=/^[#\/]/,v=/msie [\w.]+/;g.started=!1,o.extend(g.prototype,r,{interval:50,getHash:function(t){return(t=(t?t.location:window.location).href.match(/#(.*)$/))?t[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||e){var t=window.location.pathname,i=window.location.search;i&&(t+=i)}else t=this.getHash();return t.indexOf(this.options.root)||(t=t.substr(this.options.root.length)),t.replace(f,"")},start:function(t){if(g.started)throw Error("Backbone.history has already been started");g.started=!0,this.options=o.extend({},{root:"/"},this.options,t),this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var t=this.getFragment(),e=document.documentMode;return(e=v.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e))&&(this.iframe=a('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?a(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,t=window.location,e=t.pathname==this.options.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!e?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&e&&t.hash&&(this.fragment=this.getHash().replace(f,""),window.history.replaceState({},document.title,t.protocol+"//"+t.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){a(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t==this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t);return o.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(t,e){if(!g.started)return!1;e&&!0!==e||(e={trigger:e});var i=(t||"").replace(f,"");this.fragment!=i&&(this._hasPushState?(0!=i.indexOf(this.options.root)&&(i=this.options.root+i),this.fragment=i,window.history[e.replace?"replaceState":"pushState"]({},document.title,i)):this._wantsHashChange?(this.fragment=i,this._updateHash(window.location,i,e.replace),this.iframe&&i!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,i,e.replace))):window.location.assign(this.options.root+t),e.trigger&&this.loadUrl(t))},_updateHash:function(t,e,i){i?t.replace((""+t).replace(/(javascript:|#).*$/,"")+"#"+e):t.hash=e}});var y=t.View=function(t){this.cid=o.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,x="model,collection,el,id,attributes,className,tagName".split(",");o.extend(y.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(t,e,i){return t=document.createElement(t),e&&a(t).attr(e),i&&a(t).html(i),t},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a?t:a(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=E(this,"events"))){this.undelegateEvents();for(var e in t){var i=t[e];if(o.isFunction(i)||(i=this[t[e]]),!i)throw Error('Method "'+t[e]+'" does not exist');var n=e.match(b),s=n[1],n=n[2],i=o.bind(i,this),s=s+(".delegateEvents"+this.cid);""===n?this.$el.bind(s,i):this.$el.delegate(n,s,i)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=o.extend({},this.options,t));for(var e=0,i=x.length;i>e;e++){var n=x[e];t[n]&&(this[n]=t[n])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=E(this,"attributes")||{};this.id&&(t.id=this.id),this.className&&(t["class"]=this.className),this.setElement(this.make(this.tagName,t),!1)}}}),h.extend=d.extend=c.extend=y.extend=function(t,e){var i=C(this,t,e);return i.extend=this.extend,i};var w={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};t.sync=function(e,i,n){var s=w[e];n||(n={});var l={type:s,dataType:"json"};return n.url||(l.url=E(i,"url")||T()),n.data||!i||"create"!=e&&"update"!=e||(l.contentType="application/json",l.data=JSON.stringify(i.toJSON())),t.emulateJSON&&(l.contentType="application/x-www-form-urlencoded",l.data=l.data?{model:l.data}:{}),!t.emulateHTTP||"PUT"!==s&&"DELETE"!==s||(t.emulateJSON&&(l.data._method=s),l.type="POST",l.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",s)}),"GET"!==l.type&&!t.emulateJSON&&(l.processData=!1),a.ajax(o.extend(l,n))},t.wrapError=function(t,e,i){return function(n,s){s=n===e?s:n,t?t(e,s,i):e.trigger("error",e,s,i)}};var $=function(){},C=function(t,e,i){var n;return n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)},o.extend(n,t),$.prototype=t.prototype,n.prototype=new $,e&&o.extend(n.prototype,e),i&&o.extend(n,i),n.prototype.constructor=n,n.__super__=t.prototype,n},E=function(t,e){return t&&t[e]?o.isFunction(t[e])?t[e]():t[e]:null},T=function(){throw Error('A "url" property or function must be specified')}}.call(this),function(t,e){function i(t){return!!(""===t||t&&t.charCodeAt&&t.substr)}function n(t){return c?c(t):"[object Array]"===u.call(t)}function s(t){return t&&"[object Object]"===u.call(t)}function o(t,e){var i;t=t||{},e=e||{};for(i in e)e.hasOwnProperty(i)&&null==t[i]&&(t[i]=e[i]);return t}function a(t,e,i){var n,s,o=[];if(!t)return o;if(d&&t.map===d)return t.map(e,i);for(n=0,s=t.length;s>n;n++)o[n]=e.call(i,t[n],n,t);return o}function l(t,e){return t=Math.round(Math.abs(t)),isNaN(t)?e:t}function r(t){var e=h.settings.currency.format;return"function"==typeof t&&(t=t()),i(t)&&t.match("%v")?{pos:t,neg:t.replace("-","").replace("%v","-%v"),zero:t}:t&&t.pos&&t.pos.match("%v")?t:i(e)?h.settings.currency.format={pos:e,neg:e.replace("%v","-%v"),zero:e}:e
}var h={};h.version="0.3.2",h.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var d=Array.prototype.map,c=Array.isArray,u=Object.prototype.toString,p=h.unformat=h.parse=function(t,e){if(n(t))return a(t,function(t){return p(t,e)});if(t=t||0,"number"==typeof t)return t;e=e||h.settings.number.decimal;var i=RegExp("[^0-9-"+e+"]",["g"]),s=parseFloat((""+t).replace(/\((.*)\)/,"-$1").replace(i,"").replace(e,"."));return isNaN(s)?0:s},m=h.toFixed=function(t,e){e=l(e,h.settings.number.precision);var i=Math.pow(10,e);return(Math.round(h.unformat(t)*i)/i).toFixed(e)},g=h.formatNumber=function(t,e,i,r){if(n(t))return a(t,function(t){return g(t,e,i,r)});t=p(t);var d=o(s(e)?e:{precision:e,thousand:i,decimal:r},h.settings.number),c=l(d.precision),u=0>t?"-":"",f=parseInt(m(Math.abs(t||0),c),10)+"",v=f.length>3?f.length%3:0;return u+(v?f.substr(0,v)+d.thousand:"")+f.substr(v).replace(/(\d{3})(?=\d)/g,"$1"+d.thousand)+(c?d.decimal+m(Math.abs(t),c).split(".")[1]:"")};h.formatPhone=function(t){var e=/^(?:\+?1[-. ]?)?(?:\(?([0-9]{3})\)?[-. ]?)?([0-9]{3})[-. ]?([0-9]{4})$/;if(e.test(t)){var i=t.match(e),n="";return i[1]&&(n+="("+i[1]+") "),n+=i[2]+"-"+i[3]}return t};var f=h.formatMoney=function(t,e,i,d,c,u){if(n(t))return a(t,function(t){return f(t,e,i,d,c,u)});t=p(t);var m=o(s(e)?e:{symbol:e,precision:i,thousand:d,decimal:c,format:u},h.settings.currency),v=r(m.format),y=t>0?v.pos:0>t?v.neg:v.zero;return y.replace("%s",m.symbol).replace("%v",g(Math.abs(t),l(m.precision),m.thousand,m.decimal))};h.formatColumn=function(t,e,d,c,u,m){if(!t)return[];var f=o(s(e)?e:{symbol:e,precision:d,thousand:c,decimal:u,format:m},h.settings.currency),v=r(f.format),y=v.pos.indexOf("%s")<v.pos.indexOf("%v")?!0:!1,b=0,x=a(t,function(t){if(n(t))return h.formatColumn(t,f);t=p(t);var e=t>0?v.pos:0>t?v.neg:v.zero,i=e.replace("%s",f.symbol).replace("%v",g(Math.abs(t),l(f.precision),f.thousand,f.decimal));return i.length>b&&(b=i.length),i});return a(x,function(t){return i(t)&&b>t.length?y?t.replace(f.symbol,f.symbol+Array(b-t.length+1).join(" ")):Array(b-t.length+1).join(" ")+t:t})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports.accounting=h):"function"==typeof define&&define.amd?define([],function(){return h}):(h.noConflict=function(i){return function(){return t.accounting=i,h.noConflict=e,h}}(t.accounting),t.accounting=h)}(this),function(t,e){var i={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype};t.Validation=function(){var t=function(t){return e.reduce(e.keys(t.validation||{}),function(t,e){return t[e]=void 0,t},{})},s=function(t,i){var n=t.validation?t.validation[i]||{}:{};return e.isFunction(n)?n:e.isString(n)?t[n]:(e.isArray(n)||(n=[n]),e.reduce(n,function(t,i){return e.each(e.without(e.keys(i),"msg"),function(e){t.push({fn:l[e],val:i[e],msg:i.msg})}),t},[]))},o=function(t,i,n,o){var a=s(t,i);return e.isFunction(a)?a.call(t,n,i,o):e.reduce(a,function(e,s){var a=s.fn.call(l,n,i,s.val,t,o);return a===!1||e===!1?!1:a&&!e?s.msg||a:e},"")},a=function(t,i){var n,s,a={},l=!0,r=e.clone(i);for(s in i)n=o(t,s,i[s],r),n&&(a[s]=n,l=!1);return{invalidAttrs:a,isValid:l}},r=function(i,n){return{preValidate:function(t,i){return o(this,t,i,e.extend({},this.attributes))},isValid:function(t){if(e.isString(t))return!o(this,t,this.get(t),e.extend({},this.attributes));if(e.isArray(t)){for(var i=0;t.length>i;i++)if(o(this,t[i],this.get(t[i]),e.extend({},this.attributes)))return!1;return!0}return t===!0&&this.validate(),this.validation?this._isValid:!0},validate:function(s,o){var l=this,r=!s,h=e.extend({},n,o),d=e.extend(t(l),l.attributes,s),c=s||d,u=a(l,d);l._isValid=u.isValid;for(var p in d){var m=u.invalidAttrs.hasOwnProperty(p),g=c.hasOwnProperty(p);m&&(g||r)&&h.invalid(i,p,u.invalidAttrs[p],h.selector),m||h.valid(i,p,h.selector)}return e.defer(function(){l.trigger("validated",l._isValid,l,u.invalidAttrs),l.trigger("validated:"+(l._isValid?"valid":"invalid"),l,u.invalidAttrs)}),!h.forceUpdate&&e.intersection(e.keys(u.invalidAttrs),e.keys(c)).length>0?u.invalidAttrs:void 0}}},h=function(t,i,n){e.extend(i,r(t,n))},d=function(t){delete t.validate,delete t.preValidate,delete t.isValid},c=function(t){h(this.view,t,this.options)},u=function(t){d(t)};return{version:"0.6.0",configure:function(t){e.extend(i,t)},bind:function(t,s){var o=t.model,a=t.collection;s=e.extend({},i,n,s),o&&h(t,o,s),a&&(a.each(function(e){h(t,e,s)}),a.bind("add",c,{view:t,options:s}),a.bind("remove",u))},unbind:function(t){var e=t.model,i=t.collection;e&&d(t.model),i&&(i.each(function(t){d(t)}),i.unbind("add",c),i.unbind("remove",u))},mixin:r(null,i)}}();var n=t.Validation.callbacks={valid:function(t,e,i){t.$("["+i+"~="+e+"]").removeClass("invalid").removeAttr("data-error")},invalid:function(t,e,i,n){t.$("["+n+"~="+e+"]").addClass("invalid").attr("data-error",i)}},s=t.Validation.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},o=t.Validation.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},a=t.Validation.labelFormatters={none:function(t){return t},sentenceCase:function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toUpperCase():" "+t.toLowerCase()}).replace("_"," ")},label:function(t,e){return e.labels[t]||a.sentenceCase(t,e)}},l=t.Validation.validators=function(){var t=String.prototype.trim?function(t){return null===t?"":String.prototype.trim.call(t)}:function(t){var e=/^\s+/,i=/\s+$/;return null===t?"":(""+t).replace(e,"").replace(i,"")},n=function(t,e){return a[i.labelFormatter](t,e)},l=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return e.replace(/\{(\d+)\}/g,function(e,i){return t[i]!==void 0?t[i]:e})},r=function(t){return e.isNumber(t)||e.isString(t)&&t.match(s.number)},h=function(i){return!(e.isNull(i)||e.isUndefined(i)||e.isString(i)&&""===t(i))};return{fn:function(t,i,n,s,o){return e.isString(n)&&(n=s[n]),n.call(s,t,i,o)},required:function(t,i,s,a,r){var d=e.isFunction(s)?s.call(a,t,i,r):s;return d||h(t)?d&&!h(t)?l(o.required,n(i,a)):void 0:!1},acceptance:function(t,i,s,a){return"true"===t||e.isBoolean(t)&&t!==!1?void 0:l(o.acceptance,n(i,a))},min:function(t,e,i,s){return!r(t)||i>t?l(o.min,n(e,s),i):void 0},max:function(t,e,i,s){return!r(t)||t>i?l(o.max,n(e,s),i):void 0},range:function(t,e,i,s){return!r(t)||i[0]>t||t>i[1]?l(o.range,n(e,s),i[0],i[1]):void 0},length:function(e,i,s,a){return h(e)&&t(e).length===s?void 0:l(o.length,n(i,a),s)},minLength:function(e,i,s,a){return!h(e)||s>t(e).length?l(o.minLength,n(i,a),s):void 0},maxLength:function(e,i,s,a){return!h(e)||t(e).length>s?l(o.maxLength,n(i,a),s):void 0},rangeLength:function(e,i,s,a){return!h(e)||t(e).length<s[0]||t(e).length>s[1]?l(o.rangeLength,n(i,a),s[0],s[1]):void 0},oneOf:function(t,i,s,a){return e.include(s,t)?void 0:l(o.oneOf,n(i,a),s.join(", "))},equalTo:function(t,e,i,s,a){return t!==a[i]?l(o.equalTo,n(e,s),n(i,s)):void 0},pattern:function(t,e,i,a){return h(t)&&(""+t).match(s[i]||i)?void 0:l(o.pattern,n(e,a),i)}}}()}(Backbone,_);var io="undefined"==typeof module?{}:module.exports;(function(){if(function(t,e){var i=t;i.version="0.9.11",i.protocol=1,i.transports=[],i.j=[],i.sockets={},i.connect=function(t,n){var s,o,a=i.util.parseUri(t);e&&e.location&&(a.protocol=a.protocol||e.location.protocol.slice(0,-1),a.host=a.host||(e.document?e.document.domain:e.location.hostname),a.port=a.port||e.location.port),s=i.util.uniqueUri(a);var l={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return i.util.merge(l,n),(l["force new connection"]||!i.sockets[s])&&(o=new i.Socket(l)),!l["force new connection"]&&o&&(i.sockets[s]=o),o=o||i.sockets[s],o.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(t,e){var i=t.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];i.parseUri=function(t){for(var e=n.exec(t||""),i={},o=14;o--;)i[s[o]]=e[o]||"";return i},i.uniqueUri=function(t){var i=t.protocol,n=t.host,s=t.port;return"document"in e?(n=n||document.domain,s=s||("https"==i&&"https:"!==document.location.protocol?443:document.location.port)):(n=n||"localhost",!s&&"https"==i&&(s=443)),(i||"http")+"://"+n+":"+(s||80)},i.query=function(t,e){var n=i.chunkQuery(t||""),s=[];i.merge(n,i.chunkQuery(e||""));for(var o in n)n.hasOwnProperty(o)&&s.push(o+"="+n[o]);return s.length?"?"+s.join("&"):""},i.chunkQuery=function(t){for(var e,i={},n=t.split("&"),s=0,o=n.length;o>s;++s)e=n[s].split("="),e[0]&&(i[e[0]]=e[1]);return i};var o=!1;i.load=function(t){return"document"in e&&"complete"===document.readyState||o?t():(i.on(e,"load",t,!1),void 0)},i.on=function(t,e,i,n){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener&&t.addEventListener(e,i,n)},i.request=function(t){if(t&&"undefined"!=typeof XDomainRequest&&!i.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!t||i.ua.hasCORS))return new XMLHttpRequest;if(!t)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}return null},"undefined"!=typeof window&&i.load(function(){o=!0}),i.defer=function(t){return i.ua.webkit&&"undefined"==typeof importScripts?(i.load(function(){setTimeout(t,100)}),void 0):t()},i.merge=function(t,e,n,s){var o,a=s||[],l=n===void 0?2:n;for(o in e)e.hasOwnProperty(o)&&0>i.indexOf(a,o)&&("object"==typeof t[o]&&l?i.merge(t[o],e[o],l-1,a):(t[o]=e[o],a.push(e[o])));return t},i.mixin=function(t,e){i.merge(t.prototype,e.prototype)},i.inherit=function(t,e){function i(){}i.prototype=e.prototype,t.prototype=new i},i.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.intersect=function(t,e){for(var n=[],s=t.length>e.length?t:e,o=t.length>e.length?e:t,a=0,l=o.length;l>a;a++)~i.indexOf(s,o[a])&&n.push(o[a]);return n},i.indexOf=function(t,e,i){for(var n=t.length,i=0>i?0>i+n?0:i+n:i||0;n>i&&t[i]!==e;i++);return i>=n?-1:i},i.toArray=function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(t[i]);return e},i.ua={},i.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var t=new XMLHttpRequest}catch(e){return!1}return void 0!=t.withCredentials}(),i.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),i.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}(io!==void 0?io:module.exports,this),function(t,e){function i(){}t.EventEmitter=i,i.prototype.on=function(t,i){return this.$events||(this.$events={}),this.$events[t]?e.util.isArray(this.$events[t])?this.$events[t].push(i):this.$events[t]=[this.$events[t],i]:this.$events[t]=i,this},i.prototype.addListener=i.prototype.on,i.prototype.once=function(t,e){function i(){n.removeListener(t,i),e.apply(this,arguments)}var n=this;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,i){if(this.$events&&this.$events[t]){var n=this.$events[t];if(e.util.isArray(n)){for(var s=-1,o=0,a=n.length;a>o;o++)if(n[o]===i||n[o].listener&&n[o].listener===i){s=o;break}if(0>s)return this;n.splice(s,1),n.length||delete this.$events[t]}else(n===i||n.listener&&n.listener===i)&&delete this.$events[t]}return this},i.prototype.removeAllListeners=function(t){return void 0===t?(this.$events={},this):(this.$events&&this.$events[t]&&(this.$events[t]=null),this)},i.prototype.listeners=function(t){return this.$events||(this.$events={}),this.$events[t]||(this.$events[t]=[]),e.util.isArray(this.$events[t])||(this.$events[t]=[this.$events[t]]),this.$events[t]},i.prototype.emit=function(t){if(!this.$events)return!1;var i=this.$events[t];if(!i)return!1;var n=Array.prototype.slice.call(arguments,1);if("function"==typeof i)i.apply(this,n);else{if(!e.util.isArray(i))return!1;for(var s=i.slice(),o=0,a=s.length;a>o;o++)s[o].apply(this,n)}return!0}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(exports,nativeJSON){function f(t){return 10>t?"0"+t:t}function date(t){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,n,s,o,a,l=gap,r=e[t];switch(r instanceof Date&&(r=date(t)),"function"==typeof rep&&(r=rep.call(e,t,r)),typeof r){case"string":return quote(r);case"number":return isFinite(r)?r+"":"null";case"boolean":case"null":return r+"";case"object":if(!r)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(r)){for(o=r.length,i=0;o>i;i+=1)a[i]=str(i,r)||"null";return s=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+l+"]":"["+a.join(",")+"]",gap=l,s}if(rep&&"object"==typeof rep)for(o=rep.length,i=0;o>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],s=str(n,r),s&&a.push(quote(n)+(gap?": ":":")+s));else for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s=str(n,r),s&&a.push(quote(n)+(gap?": ":":")+s));return s=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+l+"}":"{"+a.join(",")+"}",gap=l,s}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(t,e,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,!e||"function"==typeof e||"object"==typeof e&&"number"==typeof e.length)return str("",{"":t});throw Error("JSON.stringify")},JSON.parse=function(text,reviver){function walk(t,e){var i,n,s=t[e];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n=walk(s,i),void 0!==n?s[i]=n:delete s[i]);return reviver.call(t,e,s)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}(io!==void 0?io:module.exports,JSON!==void 0?JSON:void 0),function(t,e){var i=t.parser={},n=i.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],s=i.reasons=["transport not supported","client not handshaken","unauthorized"],o=i.advice=["reconnect"],a=e.JSON,l=e.util.indexOf;i.encodePacket=function(t){var e=l(n,t.type),i=t.id||"",r=t.endpoint||"",h=t.ack,d=null;switch(t.type){case"error":var c=t.reason?l(s,t.reason):"",u=t.advice?l(o,t.advice):"";(""!==c||""!==u)&&(d=c+(""!==u?"+"+u:""));break;case"message":""!==t.data&&(d=t.data);break;case"event":var p={name:t.name};t.args&&t.args.length&&(p.args=t.args),d=a.stringify(p);break;case"json":d=a.stringify(t.data);break;case"connect":t.qs&&(d=t.qs);break;case"ack":d=t.ackId+(t.args&&t.args.length?"+"+a.stringify(t.args):"")}var m=[e,i+("data"==h?"+":""),r];return null!==d&&void 0!==d&&m.push(d),m.join(":")},i.encodePayload=function(t){var e="";if(1==t.length)return t[0];for(var i=0,n=t.length;n>i;i++){var s=t[i];e+="�"+s.length+"�"+t[i]}return e};var r=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;i.decodePacket=function(t){var e=t.match(r);if(!e)return{};var i=e[2]||"",t=e[5]||"",l={type:n[e[1]],endpoint:e[4]||""};switch(i&&(l.id=i,l.ack=e[3]?"data":!0),l.type){case"error":var e=t.split("+");l.reason=s[e[0]]||"",l.advice=o[e[1]]||"";break;case"message":l.data=t||"";break;case"event":try{var h=a.parse(t);l.name=h.name,l.args=h.args}catch(d){}l.args=l.args||[];break;case"json":try{l.data=a.parse(t)}catch(d){}break;case"connect":l.qs=t||"";break;case"ack":var e=t.match(/^([0-9]+)(\+)?(.*)/);if(e&&(l.ackId=e[1],l.args=[],e[3]))try{l.args=e[3]?a.parse(e[3]):[]}catch(d){}break;case"disconnect":case"heartbeat":}return l},i.decodePayload=function(t){if("�"==t.charAt(0)){for(var e=[],n=1,s="";t.length>n;n++)"�"==t.charAt(n)?(e.push(i.decodePacket(t.substr(n+1).substr(0,s))),n+=Number(s)+1,s=""):s+=t.charAt(n);return e}return[i.decodePacket(t)]}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,e){function i(t,e){this.socket=t,this.sessid=e}t.Transport=i,e.util.mixin(i,e.EventEmitter),i.prototype.heartbeats=function(){return!0},i.prototype.onData=function(t){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==t){var i=e.parser.decodePayload(t);if(i&&i.length)for(var n=0,s=i.length;s>n;n++)this.onPacket(i[n])}return this},i.prototype.onPacket=function(t){return this.socket.setHeartbeatTimeout(),"heartbeat"==t.type?this.onHeartbeat():("connect"==t.type&&""==t.endpoint&&this.onConnect(),"error"==t.type&&"reconnect"==t.advice&&(this.isOpen=!1),this.socket.onPacket(t),this)},i.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var t=this;this.closeTimeout=setTimeout(function(){t.onDisconnect()},this.socket.closeTimeout)}},i.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},i.prototype.onConnect=function(){return this.socket.onConnect(),this},i.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},i.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},i.prototype.packet=function(t){this.send(e.parser.encodePacket(t))},i.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},i.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},i.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},i.prototype.prepareUrl=function(){var t=this.socket.options;return this.scheme()+"://"+t.host+":"+t.port+"/"+t.resource+"/"+e.protocol+"/"+this.name+"/"+this.sessid},i.prototype.ready=function(t,e){e.call(this)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,e,i){function n(t){if(this.options={port:80,secure:!1,document:"document"in i?document:!1,resource:"socket.io",transports:e.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},e.util.merge(this.options,t),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||e.util.ua.hasCORS)){var n=this;e.util.on(i,"beforeunload",function(){n.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function s(){}t.Socket=n,e.util.mixin(n,e.EventEmitter),n.prototype.of=function(t){return this.namespaces[t]||(this.namespaces[t]=new e.SocketNamespace(this,t),""!==t&&this.namespaces[t].packet({type:"connect"})),this.namespaces[t]},n.prototype.publish=function(){this.emit.apply(this,arguments);var t;for(var e in this.namespaces)this.namespaces.hasOwnProperty(e)&&(t=this.of(e),t.$emit.apply(t,arguments))},n.prototype.handshake=function(t){function i(e){e instanceof Error?(n.connecting=!1,n.onError(e.message)):t.apply(null,e.split(":"))}var n=this,o=this.options,a=["http"+(o.secure?"s":"")+":/",o.host+":"+o.port,o.resource,e.protocol,e.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!e.util.ua.hasCORS){var l=document.getElementsByTagName("script")[0],r=document.createElement("script");r.src=a+"&jsonp="+e.j.length,l.parentNode.insertBefore(r,l),e.j.push(function(t){i(t),r.parentNode.removeChild(r)})}else{var h=e.util.request();h.open("GET",a,!0),this.isXDomain()&&(h.withCredentials=!0),h.onreadystatechange=function(){4==h.readyState&&(h.onreadystatechange=s,200==h.status?i(h.responseText):403==h.status?n.onError(h.responseText):(n.connecting=!1,!n.reconnecting&&n.onError(h.responseText)))},h.send(null)}},n.prototype.getTransport=function(t){for(var i,n=t||this.transports,s=0;i=n[s];s++)if(e.Transport[i]&&e.Transport[i].check(this)&&(!this.isXDomain()||e.Transport[i].xdomainCheck(this)))return new e.Transport[i](this,this.sessionid);return null},n.prototype.connect=function(t){if(this.connecting)return this;var i=this;return i.connecting=!0,this.handshake(function(n,s,o,a){function l(t){return i.transport&&i.transport.clearTimeouts(),i.transport=i.getTransport(t),i.transport?(i.transport.ready(i,function(){i.connecting=!0,i.publish("connecting",i.transport.name),i.transport.open(),i.options["connect timeout"]&&(i.connectTimeoutTimer=setTimeout(function(){if(!i.connected&&(i.connecting=!1,i.options["try multiple transports"])){for(var t=i.transports;t.length>0&&t.splice(0,1)[0]!=i.transport.name;);t.length?l(t):i.publish("connect_failed")}},i.options["connect timeout"]))}),void 0):i.publish("connect_failed")}i.sessionid=n,i.closeTimeout=1e3*o,i.heartbeatTimeout=1e3*s,i.transports||(i.transports=i.origTransports=a?e.util.intersect(a.split(","),i.options.transports):i.options.transports),i.setHeartbeatTimeout(),l(i.transports),i.once("connect",function(){clearTimeout(i.connectTimeoutTimer),t&&"function"==typeof t&&t()})}),this},n.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var t=this;this.heartbeatTimeoutTimer=setTimeout(function(){t.transport.onClose()},this.heartbeatTimeout)}},n.prototype.packet=function(t){return this.connected&&!this.doBuffer?this.transport.packet(t):this.buffer.push(t),this},n.prototype.setBuffer=function(t){this.doBuffer=t,!t&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},n.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var t=e.util.request(),i=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,e.protocol,"",this.sessionid].join("/")+"/?disconnect=1";t.open("GET",i,!1),t.send(null),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var t=i.location.port||("https:"==i.location.protocol?443:80);return this.options.host!==i.location.hostname||this.options.port!=t},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.open=!0},n.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(t){this.of(t.endpoint).onPacket(t)},n.prototype.onError=function(t){t&&t.advice&&"reconnect"===t.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",t&&t.reason?t.reason:t)},n.prototype.onDisconnect=function(t){var e=this.connected,i=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(e||i)&&(this.transport.close(),this.transport.clearTimeouts(),e&&(this.publish("disconnect",t),"booted"!=t&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},n.prototype.reconnect=function(){function t(){if(i.connected){for(var t in i.namespaces)i.namespaces.hasOwnProperty(t)&&""!==t&&i.namespaces[t].packet({type:"connect"});i.publish("reconnect",i.transport.name,i.reconnectionAttempts)}clearTimeout(i.reconnectionTimer),i.removeListener("connect_failed",e),i.removeListener("connect",e),i.reconnecting=!1,delete i.reconnectionAttempts,delete i.reconnectionDelay,delete i.reconnectionTimer,delete i.redoTransports,i.options["try multiple transports"]=s}function e(){return i.reconnecting?i.connected?t():i.connecting&&i.reconnecting?i.reconnectionTimer=setTimeout(e,1e3):(i.reconnectionAttempts++>=n?i.redoTransports?(i.publish("reconnect_failed"),t()):(i.on("connect_failed",e),i.options["try multiple transports"]=!0,i.transports=i.origTransports,i.transport=i.getTransport(),i.redoTransports=!0,i.connect()):(o>i.reconnectionDelay&&(i.reconnectionDelay*=2),i.connect(),i.publish("reconnecting",i.reconnectionDelay,i.reconnectionAttempts),i.reconnectionTimer=setTimeout(e,i.reconnectionDelay)),void 0):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var i=this,n=this.options["max reconnection attempts"],s=this.options["try multiple transports"],o=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(e,this.reconnectionDelay),this.on("connect",e)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports,this),function(t,e){function i(t,e){this.socket=t,this.name=e||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(t,e){this.namespace=t,this.name=e}t.SocketNamespace=i,e.util.mixin(i,e.EventEmitter),i.prototype.$emit=e.EventEmitter.prototype.emit,i.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},i.prototype.packet=function(t){return t.endpoint=this.name,this.socket.packet(t),this.flags={},this},i.prototype.send=function(t,e){var i={type:this.flags.json?"json":"message",data:t};return"function"==typeof e&&(i.id=++this.ackPackets,i.ack=!0,this.acks[i.id]=e),this.packet(i)},i.prototype.emit=function(t){var e=Array.prototype.slice.call(arguments,1),i=e[e.length-1],n={type:"event",name:t};return"function"==typeof i&&(n.id=++this.ackPackets,n.ack="data",this.acks[n.id]=i,e=e.slice(0,e.length-1)),n.args=e,this.packet(n)},i.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},i.prototype.onPacket=function(t){function i(){n.packet({type:"ack",args:e.util.toArray(arguments),ackId:t.id})}var n=this;switch(t.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(t.reason||"booted"):this.$emit("disconnect",t.reason);break;case"message":case"json":var s=["message",t.data];"data"==t.ack?s.push(i):t.ack&&this.packet({type:"ack",ackId:t.id}),this.$emit.apply(this,s);break;case"event":var s=[t.name].concat(t.args);"data"==t.ack&&s.push(i),this.$emit.apply(this,s);break;case"ack":this.acks[t.ackId]&&(this.acks[t.ackId].apply(this,t.args),delete this.acks[t.ackId]);break;case"error":t.advice?this.socket.onError(t):"unauthorized"==t.reason?this.$emit("connect_failed",t.reason):this.$emit("error",t.reason)}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,e,i){function n(){e.Transport.apply(this,arguments)}t.websocket=n,e.util.inherit(n,e.Transport),n.prototype.name="websocket",n.prototype.open=function(){var t,n=e.util.query(this.socket.options.query),s=this;return t||(t=i.MozWebSocket||i.WebSocket),this.websocket=new t(this.prepareUrl()+n),this.websocket.onopen=function(){s.onOpen(),s.socket.setBuffer(!1)},this.websocket.onmessage=function(t){s.onData(t.data)},this.websocket.onclose=function(){s.onClose(),s.socket.setBuffer(!0)},this.websocket.onerror=function(t){s.onError(t)},this},n.prototype.send=e.util.ua.iDevice?function(t){var e=this;return setTimeout(function(){e.websocket.send(t)},0),this}:function(t){return this.websocket.send(t),this},n.prototype.payload=function(t){for(var e=0,i=t.length;i>e;e++)this.packet(t[e]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(t){this.socket.onError(t)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in i&&!("__addTask"in WebSocket)||"MozWebSocket"in i},n.xdomainCheck=function(){return!0},e.transports.push("websocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,this),function(t,e){function i(){e.Transport.websocket.apply(this,arguments)}t.flashsocket=i,e.util.inherit(i,e.Transport.websocket),i.prototype.name="flashsocket",i.prototype.open=function(){var t=this,i=arguments;return WebSocket.__addTask(function(){e.Transport.websocket.prototype.open.apply(t,i)}),this},i.prototype.send=function(){var t=this,i=arguments;return WebSocket.__addTask(function(){e.Transport.websocket.prototype.send.apply(t,i)}),this},i.prototype.close=function(){return WebSocket.__tasks.length=0,e.Transport.websocket.prototype.close.call(this),this
},i.prototype.ready=function(t,n){function s(){var e=t.options,s=e["flash policy port"],a=["http"+(e.secure?"s":"")+":/",e.host+":"+e.port,e.resource,"static/flashsocket","WebSocketMain"+(t.isXDomain()?"Insecure":"")+".swf"];i.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=a.join("/")),843!==s&&WebSocket.loadFlashPolicyFile("xmlsocket://"+e.host+":"+s),WebSocket.__initialize(),i.loaded=!0),n.call(o)}var o=this;return document.body?s():(e.util.load(s),void 0)},i.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},i.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),e.transports.push("flashsocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function t(){if(!L){try{var t=_.getElementsByTagName("body")[0].appendChild(f("span"));t.parentNode.removeChild(t)}catch(e){return}L=!0;for(var i=M.length,n=0;i>n;n++)M[n]()}}function e(t){L?t():M[M.length]=t}function i(t){if(typeof R.addEventListener!=V)R.addEventListener("load",t,!1);else if(typeof _.addEventListener!=V)_.addEventListener("load",t,!1);else if(typeof R.attachEvent!=V)v(R,"onload",t);else if("function"==typeof R.onload){var e=R.onload;R.onload=function(){e(),t()}}else R.onload=t}function n(){I?s():o()}function s(){var t=_.getElementsByTagName("body")[0],e=f(S);e.setAttribute("type",F);var i=t.appendChild(e);if(i){var n=0;(function(){if(typeof i.GetVariable!=V){var s=i.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),J.pv=[parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)])}else if(10>n)return n++,setTimeout(arguments.callee,10),void 0;t.removeChild(e),i=null,o()})()}else o()}function o(){var t=H.length;if(t>0)for(var e=0;t>e;e++){var i=H[e].id,n=H[e].callbackFn,s={success:!1,id:i};if(J.pv[0]>0){var o=g(i);if(o)if(!y(H[e].swfVersion)||J.wk&&312>J.wk)if(H[e].expressInstall&&l()){var d={};d.data=H[e].expressInstall,d.width=o.getAttribute("width")||"0",d.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(d.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(d.align=o.getAttribute("align"));for(var c={},u=o.getElementsByTagName("param"),p=u.length,m=0;p>m;m++)"movie"!=u[m].getAttribute("name").toLowerCase()&&(c[u[m].getAttribute("name")]=u[m].getAttribute("value"));r(d,c,i,n)}else h(o),n&&n(s);else x(i,!0),n&&(s.success=!0,s.ref=a(i),n(s))}else if(x(i,!0),n){var f=a(i);f&&typeof f.SetVariable!=V&&(s.success=!0,s.ref=f),n(s)}}}function a(t){var e=null,i=g(t);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=V)e=i;else{var n=i.getElementsByTagName(S)[0];n&&(e=n)}return e}function l(){return!W&&y("6.0.65")&&(J.win||J.mac)&&!(J.wk&&312>J.wk)}function r(t,e,i,n){W=!0,E=n||null,T={success:!1,id:i};var s=g(i);if(s){"OBJECT"==s.nodeName?($=d(s),C=null):($=s,C=i),t.id=P,(typeof t.width==V||!/%$/.test(t.width)&&310>parseInt(t.width,10))&&(t.width="310"),(typeof t.height==V||!/%$/.test(t.height)&&137>parseInt(t.height,10))&&(t.height="137"),_.title=_.title.slice(0,47)+" - Flash Player Installation";var o=J.ie&&J.win?["Active"].concat("").join("X"):"PlugIn",a="MMredirectURL="+(""+R.location).replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+_.title;if(typeof e.flashvars!=V?e.flashvars+="&"+a:e.flashvars=a,J.ie&&J.win&&4!=s.readyState){var l=f("div");i+="SWFObjectNew",l.setAttribute("id",i),s.parentNode.insertBefore(l,s),s.style.display="none",function(){4==s.readyState?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}c(t,e,i)}}function h(t){if(J.ie&&J.win&&4!=t.readyState){var e=f("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(d(t),e),t.style.display="none",function(){4==t.readyState?t.parentNode.removeChild(t):setTimeout(arguments.callee,10)}()}else t.parentNode.replaceChild(d(t),t)}function d(t){var e=f("div");if(J.win&&J.ie)e.innerHTML=t.innerHTML;else{var i=t.getElementsByTagName(S)[0];if(i){var n=i.childNodes;if(n)for(var s=n.length,o=0;s>o;o++)(1!=n[o].nodeType||"PARAM"!=n[o].nodeName)&&8!=n[o].nodeType&&e.appendChild(n[o].cloneNode(!0))}}return e}function c(t,e,i){var n,s=g(i);if(J.wk&&312>J.wk)return n;if(s)if(typeof t.id==V&&(t.id=i),J.ie&&J.win){var o="";for(var a in t)t[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?e.movie=t[a]:"styleclass"==a.toLowerCase()?o+=' class="'+t[a]+'"':"classid"!=a.toLowerCase()&&(o+=" "+a+'="'+t[a]+'"'));var l="";for(var r in e)e[r]!=Object.prototype[r]&&(l+='<param name="'+r+'" value="'+e[r]+'" />');s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+o+">"+l+"</object>",j[j.length]=t.id,n=g(t.id)}else{var h=f(S);h.setAttribute("type",F);for(var d in t)t[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?h.setAttribute("class",t[d]):"classid"!=d.toLowerCase()&&h.setAttribute(d,t[d]));for(var c in e)e[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&u(h,c,e[c]);s.parentNode.replaceChild(h,s),n=h}return n}function u(t,e,i){var n=f("param");n.setAttribute("name",e),n.setAttribute("value",i),t.appendChild(n)}function p(t){var e=g(t);e&&"OBJECT"==e.nodeName&&(J.ie&&J.win?(e.style.display="none",function(){4==e.readyState?m(t):setTimeout(arguments.callee,10)}()):e.parentNode.removeChild(e))}function m(t){var e=g(t);if(e){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode.removeChild(e)}}function g(t){var e=null;try{e=_.getElementById(t)}catch(i){}return e}function f(t){return _.createElement(t)}function v(t,e,i){t.attachEvent(e,i),z[z.length]=[t,e,i]}function y(t){var e=J.pv,i=t.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,e[0]>i[0]||e[0]==i[0]&&e[1]>i[1]||e[0]==i[0]&&e[1]==i[1]&&e[2]>=i[2]?!0:!1}function b(t,e,i,n){if(!J.ie||!J.mac){var s=_.getElementsByTagName("head")[0];if(s){var o=i&&"string"==typeof i?i:"screen";if(n&&(k=null,A=null),!k||A!=o){var a=f("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),k=s.appendChild(a),J.ie&&J.win&&typeof _.styleSheets!=V&&_.styleSheets.length>0&&(k=_.styleSheets[_.styleSheets.length-1]),A=o}J.ie&&J.win?k&&typeof k.addRule==S&&k.addRule(t,e):k&&typeof _.createTextNode!=V&&k.appendChild(_.createTextNode(t+" {"+e+"}"))}}}function x(t,e){if(q){var i=e?"visible":"hidden";L&&g(t)?g(t).style.visibility=i:b("#"+t,"visibility:"+i)}}function w(t){var e=/[\\\"<>\.;]/,i=null!=e.exec(t);return i&&typeof encodeURIComponent!=V?encodeURIComponent(t):t}var $,C,E,T,k,A,V="undefined",S="object",O="Shockwave Flash",N="ShockwaveFlash.ShockwaveFlash",F="application/x-shockwave-flash",P="SWFObjectExprInst",D="onreadystatechange",R=window,_=document,B=navigator,I=!1,M=[n],H=[],j=[],z=[],L=!1,W=!1,q=!0,J=function(){var t=typeof _.getElementById!=V&&typeof _.getElementsByTagName!=V&&typeof _.createElement!=V,e=B.userAgent.toLowerCase(),i=B.platform.toLowerCase(),n=i?/win/.test(i):/win/.test(e),s=i?/mac/.test(i):/mac/.test(e),o=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,l=[0,0,0],r=null;if(typeof B.plugins!=V&&typeof B.plugins[O]==S)r=B.plugins[O].description,r&&(typeof B.mimeTypes==V||!B.mimeTypes[F]||!!B.mimeTypes[F].enabledPlugin)&&(I=!0,a=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),l[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),l[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),l[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof R[["Active"].concat("Object").join("X")]!=V)try{var h=new(window[["Active"].concat("Object").join("X")])(N);h&&(r=h.GetVariable("$version"),r&&(a=!0,r=r.split(" ")[1].split(","),l=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(d){}return{w3:t,pv:l,wk:o,ie:a,win:n,mac:s}}();return function(){J.w3&&((typeof _.readyState!=V&&"complete"==_.readyState||typeof _.readyState==V&&(_.getElementsByTagName("body")[0]||_.body))&&t(),L||(typeof _.addEventListener!=V&&_.addEventListener("DOMContentLoaded",t,!1),J.ie&&J.win&&(_.attachEvent(D,function(){"complete"==_.readyState&&(_.detachEvent(D,arguments.callee),t())}),R==top&&function(){if(!L){try{_.documentElement.doScroll("left")}catch(e){return setTimeout(arguments.callee,0),void 0}t()}}()),J.wk&&function(){return L?void 0:/loaded|complete/.test(_.readyState)?(t(),void 0):(setTimeout(arguments.callee,0),void 0)}(),i(t)))}(),function(){J.ie&&J.win&&window.attachEvent("onunload",function(){for(var t=z.length,e=0;t>e;e++)z[e][0].detachEvent(z[e][1],z[e][2]);for(var i=j.length,n=0;i>n;n++)p(j[n]);for(var s in J)J[s]=null;J=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}(),{registerObject:function(t,e,i,n){if(J.w3&&t&&e){var s={};s.id=t,s.swfVersion=e,s.expressInstall=i,s.callbackFn=n,H[H.length]=s,x(t,!1)}else n&&n({success:!1,id:t})},getObjectById:function(t){return J.w3?a(t):void 0},embedSWF:function(t,i,n,s,o,a,h,d,u,p){var m={success:!1,id:i};J.w3&&!(J.wk&&312>J.wk)&&t&&i&&n&&s&&o?(x(i,!1),e(function(){n+="",s+="";var e={};if(u&&typeof u===S)for(var g in u)e[g]=u[g];e.data=t,e.width=n,e.height=s;var f={};if(d&&typeof d===S)for(var v in d)f[v]=d[v];if(h&&typeof h===S)for(var b in h)typeof f.flashvars!=V?f.flashvars+="&"+b+"="+h[b]:f.flashvars=b+"="+h[b];if(y(o)){var w=c(e,f,i);e.id==i&&x(i,!0),m.success=!0,m.ref=w}else{if(a&&l())return e.data=a,r(e,f,i,p),void 0;x(i,!0)}p&&p(m)})):p&&p(m)},switchOffAutoHideShow:function(){q=!1},ua:J,getFlashPlayerVersion:function(){return{major:J.pv[0],minor:J.pv[1],release:J.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(t,e,i){return J.w3?c(t,e,i):void 0},showExpressInstall:function(t,e,i,n){J.w3&&l()&&r(t,e,i,n)},removeSWF:function(t){J.w3&&p(t)},createCSS:function(t,e,i,n){J.w3&&b(t,e,i,n)},addDomLoadEvent:e,addLoadEvent:i,getQueryParamValue:function(t){var e=_.location.search||_.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),null==t)return w(e);for(var i=e.split("&"),n=0;i.length>n;n++)if(i[n].substring(0,i[n].indexOf("="))==t)return w(i[n].substring(i[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var t=g(P);t&&$&&(t.parentNode.replaceChild($,t),C&&(x(C,!0),J.ie&&J.win&&($.style.display="block")),E&&E(T)),W=!1}}}}();(function(){if("undefined"!=typeof window&&!window.WebSocket){var t=window.console;return t&&t.log&&t.error||(t={log:function(){},error:function(){}}),swfobject.hasFlashPlayerVersion("10.0.0")?("file:"==location.protocol&&t.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(t,e,i,n,s){var o=this;o.__id=WebSocket.__nextId++,WebSocket.__instances[o.__id]=o,o.readyState=WebSocket.CONNECTING,o.bufferedAmount=0,o.__events={},e?"string"==typeof e&&(e=[e]):e=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(o.__id,t,e,i||null,n||0,s||null)})},0)},WebSocket.prototype.send=function(t){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var e=WebSocket.__flash.send(this.__id,encodeURIComponent(t));return 0>e?!0:(this.bufferedAmount+=e,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(t,e){t in this.__events||(this.__events[t]=[]),this.__events[t].push(e)},WebSocket.prototype.removeEventListener=function(t,e){if(t in this.__events)for(var i=this.__events[t],n=i.length-1;n>=0;--n)if(i[n]===e){i.splice(n,1);break}},WebSocket.prototype.dispatchEvent=function(t){for(var e=this.__events[t.type]||[],i=0;e.length>i;++i)e[i](t);var n=this["on"+t.type];n&&n(t)},WebSocket.prototype.__handleEvent=function(t){"readyState"in t&&(this.readyState=t.readyState),"protocol"in t&&(this.protocol=t.protocol);var e;if("open"==t.type||"error"==t.type)e=this.__createSimpleEvent(t.type);else if("close"==t.type)e=this.__createSimpleEvent("close");else{if("message"!=t.type)throw"unknown event type: "+t.type;var i=decodeURIComponent(t.message);e=this.__createMessageEvent("message",i)}this.dispatchEvent(e)},WebSocket.prototype.__createSimpleEvent=function(t){if(document.createEvent&&window.Event){var e=document.createEvent("Event");return e.initEvent(t,!1,!1),e}return{type:t,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(t,e){if(document.createEvent&&window.MessageEvent&&!window.opera){var i=document.createEvent("MessageEvent");return i.initMessageEvent("message",!1,!1,e,null,null,window,null),i}return{type:t,data:e,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(t){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(t)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return t.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf"),void 0;var e=document.createElement("div");e.id="webSocketContainer",e.style.position="absolute",WebSocket.__isFlashLite()?(e.style.left="0px",e.style.top="0px"):(e.style.left="-100px",e.style.top="-100px");var i=document.createElement("div");i.id="webSocketFlash",e.appendChild(i),document.body.appendChild(e),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(e){e.success||t.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var t=0;WebSocket.__tasks.length>t;++t)WebSocket.__tasks[t]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var e=WebSocket.__flash.receiveEvents(),i=0;e.length>i;++i)WebSocket.__instances[e[i].webSocketId].__handleEvent(e[i])}catch(n){t.error(n)}},0),!0},WebSocket.__log=function(e){t.log(decodeURIComponent(e))},WebSocket.__error=function(e){t.error(decodeURIComponent(e))},WebSocket.__addTask=function(t){WebSocket.__flash?t():WebSocket.__tasks.push(t)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var t=window.navigator.mimeTypes["application/x-shockwave-flash"];return t&&t.enabledPlugin&&t.enabledPlugin.filename?t.enabledPlugin.filename.match(/flashlite/i)?!0:!1:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()})),void 0):(t.error("Flash Player >= 10.0.0 is required."),void 0)}})(),function(t,e,i){function n(t){t&&(e.Transport.apply(this,arguments),this.sendBuffer=[])}function s(){}t.XHR=n,e.util.inherit(n,e.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(t){for(var i=[],n=0,s=t.length;s>n;n++)i.push(e.parser.encodePacket(t[n]));this.send(e.parser.encodePayload(i))},n.prototype.send=function(t){return this.post(t),this},n.prototype.post=function(t){function e(){4==this.readyState&&(this.onreadystatechange=s,o.posting=!1,200==this.status?o.socket.setBuffer(!1):o.onClose())}function n(){this.onload=s,o.socket.setBuffer(!1)}var o=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),i.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=n:this.sendXHR.onreadystatechange=e,this.sendXHR.send(t)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(t){var i=e.util.request(this.socket.isXDomain()),n=e.util.query(this.socket.options.query,"t="+ +new Date);if(i.open(t||"GET",this.prepareUrl()+n,!0),"POST"==t)try{i.setRequestHeader?i.setRequestHeader("Content-type","text/plain;charset=UTF-8"):i.contentType="text/plain"}catch(s){}return i},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(t,n){try{var s=e.util.request(n),o=i.XDomainRequest&&s instanceof XDomainRequest,a=t&&t.options&&t.options.secure?"https:":"http:",l=i.location&&a!=i.location.protocol;if(s&&(!o||!l))return!0}catch(r){}return!1},n.xdomainCheck=function(t){return n.check(t,!0)}}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,this),function(t,e){function i(){e.Transport.XHR.apply(this,arguments)}t.htmlfile=i,e.util.inherit(i,e.Transport.XHR),i.prototype.name="htmlfile",i.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var t=this.doc.createElement("div");t.className="socketio",this.doc.body.appendChild(t),this.iframe=this.doc.createElement("iframe"),t.appendChild(this.iframe);var i=this,n=e.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+n,e.util.on(window,"unload",function(){i.destroy()})},i.prototype._=function(t,e){this.onData(t);try{var i=e.getElementsByTagName("script")[0];i.parentNode.removeChild(i)}catch(n){}},i.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(t){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},i.prototype.close=function(){return this.destroy(),e.Transport.XHR.prototype.close.call(this)},i.check=function(t){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var i=new(window[["Active"].concat("Object").join("X")])("htmlfile");return i&&e.Transport.XHR.check(t)}catch(n){}return!1},i.xdomainCheck=function(){return!1},e.transports.push("htmlfile")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports),function(t,e,i){function n(){e.Transport.XHR.apply(this,arguments)}function s(){}t["xhr-polling"]=n,e.util.inherit(n,e.Transport.XHR),e.util.merge(n,e.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.heartbeats=function(){return!1},n.prototype.open=function(){var t=this;return e.Transport.XHR.prototype.open.call(t),!1},n.prototype.get=function(){function t(){4==this.readyState&&(this.onreadystatechange=s,200==this.status?(o.onData(this.responseText),o.get()):o.onClose())}function e(){this.onload=s,this.onerror=s,o.retryCounter=1,o.onData(this.responseText),o.get()}function n(){o.retryCounter++,!o.retryCounter||o.retryCounter>3?o.onClose():o.get()}if(this.isOpen){var o=this;this.xhr=this.request(),i.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=e,this.xhr.onerror=n):this.xhr.onreadystatechange=t,this.xhr.send(null)}},n.prototype.onClose=function(){if(e.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=s;try{this.xhr.abort()}catch(t){}this.xhr=null}},n.prototype.ready=function(t,i){var n=this;e.util.defer(function(){i.call(n)})},e.transports.push("xhr-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,this),function(t,e,i){function n(){e.Transport["xhr-polling"].apply(this,arguments),this.index=e.j.length;var t=this;e.j.push(function(e){t._(e)})}var s=i.document&&"MozAppearance"in i.document.documentElement.style;t["jsonp-polling"]=n,e.util.inherit(n,e.Transport["xhr-polling"]),n.prototype.name="jsonp-polling",n.prototype.post=function(t){function i(){n(),s.socket.setBuffer(!1)}function n(){s.iframe&&s.form.removeChild(s.iframe);try{a=document.createElement('<iframe name="'+s.iframeId+'">')}catch(t){a=document.createElement("iframe"),a.name=s.iframeId}a.id=s.iframeId,s.form.appendChild(a),s.iframe=a}var s=this,o=e.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var a,l=document.createElement("form"),r=document.createElement("textarea"),h=this.iframeId="socketio_iframe_"+this.index;l.className="socketio",l.style.position="absolute",l.style.top="0px",l.style.left="0px",l.style.display="none",l.target=h,l.method="POST",l.setAttribute("accept-charset","utf-8"),r.name="d",l.appendChild(r),document.body.appendChild(l),this.form=l,this.area=r}this.form.action=this.prepareUrl()+o,n(),this.area.value=e.JSON.stringify(t);try{this.form.submit()}catch(d){}this.iframe.attachEvent?a.onreadystatechange=function(){"complete"==s.iframe.readyState&&i()}:this.iframe.onload=i,this.socket.setBuffer(!0)},n.prototype.get=function(){var t=this,i=document.createElement("script"),n=e.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),i.async=!0,i.src=this.prepareUrl()+n,i.onerror=function(){t.onClose()};var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(i,o),this.script=i,s&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},n.prototype._=function(t){return this.onData(t),this.isOpen&&this.get(),this},n.prototype.ready=function(t,i){var n=this;return s?(e.util.load(function(){i.call(n)}),void 0):i.call(this)},n.check=function(){return"document"in i},n.xdomainCheck=function(){return!0},e.transports.push("jsonp-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})})();